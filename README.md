# 交通費請求書作成支援ツール

## 概要

このプロジェクトは、給与明細（PDF）とSuicaの利用履歴（PDF）から、勤務日、勤務地、交通費の情報を抽出し、交通費請求書の作成を支援することを目的としています。

## プロジェクト構成

- `main.pyw`: GUIアプリケーションのメインファイルです。PySimpleGUIを使用しています。
- `Process.py`: 給与明細PDFから勤務日と勤務地の情報を抽出する処理を記述したモジュールです。
- `test.ipynb`: Suicaの利用履歴PDFから交通費の情報を抽出する処理を記述したJupyter Notebookです。
- `sample/`: サンプルデータが格納されています。
    - `給与明細書_20240119141639.pdf`: 給与明細のサンプルPDFです。
    - `JE80F121120754077_20231016_20240115160118.pdf`: Suica利用履歴のpdfファイルです。
    - `JE80F121120754077_20231016_20240115160118.txt`: Suica利用履歴のサンプルテキストファイルです。
    - `d54ff476ff529c75ab262cbbed599019.xlsx`: 会社が用意した交通費請求書のExcelファイルです。

## 機能

### 給与明細からの情報抽出 (`Process.py`)

- `extract_workday_from_salary_pdf(path)`: 給与明細のPDFファイルパスを引数に取り、勤務日と勤務地のリストを返します。
    - `tabula-py`ライブラリを使用してPDFからテーブル情報を抽出します。
    - "日付"という文字列を基準に、勤務日と勤務地の情報を抽出します。

### Suica利用履歴からの情報抽出 (`test.ipynb`)

- `extract_suica_history(path)`: Suica利用履歴のPDFファイルパスを引数に取り、利用履歴のDataFrameを返します。
- `convert_dataframe(df)`: DataFrameのデータ型を変換します。
- `add_year(df, date_obj)`: 利用履歴に年情報を付与します。

### GUIアプリケーション (`main.pyw`)

- ファイル選択ダイアログから給与明細PDFを選択できます。
- 選択したPDFから抽出した勤務日と勤務地の一覧を表形式で表示します。

## 課題

- Suica利用履歴の抽出処理がJupyter Notebook（`test.ipynb`）に記述されており、GUIアプリケーションに統合されていません。
- エラーハンドリングが実装されていません。
- 交通費請求書の自動作成機能は未実装です。
