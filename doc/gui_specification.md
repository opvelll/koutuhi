# GUI 仕様書

## 概要
`main_gui.pyw` は、Suica 利用履歴 PDF を入力として、通勤経路情報をプレビュー表示し、選択されたデータから勤務表（Excel）を自動生成する GUI アプリケーションです。

## 画面構成

1. **Suica PDF ファイル**
   - ファイルパス入力フィールドと「Browse」ボタン
   - PDF ファイルを選択

2. **テンプレート Excel**
   - 出力用の Excel テンプレートファイル（.xlsx）を選択

3. **出力フォルダ**
   - 勤務表ファイルの出力先ディレクトリを選択

4. **Load ボタン**
   - PDF を読み込み、Suica 履歴を解析
   - テーブル形式でプレビュー表示
     - 列：日付（YYYY-MM-DD）、種別1、利用駅1、種別2、利用駅2、支払額、残額
     - 最終列に「使用する」チェックボックスを配置
     - `利用駅1` または `利用駅2` が空欄の場合、チェックを外し、選択不可にする
     - 水平／垂直スクロール対応、ウィンドウリサイズ可能

5. **Generate ボタン**
   - テーブルのチェックが入った行を抽出
   - 指定したテンプレートと出力フォルダを使用して勤務表を生成
   - 処理完了後にダイアログで通知

6. **Exit ボタン**
   - アプリケーション終了

## 動作フロー

1. アプリ起動
2. PDF ファイル、テンプレート Excel、出力フォルダを設定
3. `Load` を押す
   - PDF を解析し、プレビューを表示
   - ユーザーはチェックボックスで生成対象レコードを選択
4. `Generate` を押す
   - 選択レコードから勤務表を生成
   - 出力ディレクトリに `勤務表_YYYY-MM.xlsx` ファイルを保存
5. `Exit` で終了

## 依存ライブラリ

- PySimpleGUI
- pandas
- openpyxl
- PyMuPDF 他

---
*ドキュメントを確認後、リポジトリにコミットしてください。*
